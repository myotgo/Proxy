# لایه ۷: V2Ray VMess - مخفی‌سازی پیشرفته

> **⭐⭐⭐⭐ برای سانسور سخت**
> پورت 443 - پروتکل VMess با WebSocket

[← بازگشت به راهنمای اصلی](../README.fa.md)

---

## این روش چیست؟

V2Ray با پروتکل VMess - یک پروتکل پیشرفته که ترافیک را به‌طور کامل مخفی می‌کند.
از WebSocket استفاده می‌کند تا دقیقاً شبیه ترافیک وب معمولی باشد.

**مزایا:**
- مخفی‌سازی بسیار پیشرفته
- از سانسور سخت عبور می‌کند
- شبیه ترافیک وب واقعی
- پروتکل VMess قدرتمند

**نسبت به لایه‌های قبلی:**
- سخت‌ترین برای شناسایی
- بهترین برای محیط‌های سانسور سخت
- نصب و تنظیم پیچیده‌تر
- نیاز به کلاینت V2Ray

---

--------------------------------------------------
مرحله ۱: خرید سرور VPS
--------------------------------------------------

**اگر از قبل سرور لینوکس با Ubuntu دارید، این مرحله را رد کنید و به مرحله ۲ بروید.**

**برای خرید از IONOS (پیشنهادی):** [راهنمای خرید سرور از IONOS](../buy-ionos-server.fa.md)

### نکات خرید:
- سیستم‌عامل: **Ubuntu**
- پلن ارزان کافی است
- لوکیشن به انتخاب شما

**اطلاعات مورد نیاز از سرور:**
- IP سرور
- نام کاربری: root
- رمز عبور

---

--------------------------------------------------
مرحله ۲: اتصال SSH
--------------------------------------------------

**[راهنمای اتصال به سرور با SSH](../ssh-connection.fa.md)**

خلاصه:
```bash
ssh root@SERVER-IP
```

---

--------------------------------------------------
مرحله ۳: نصب لایه ۷ (V2Ray VMess)
--------------------------------------------------

این دستور را اجرا کنید:

```bash
curl -fsSL https://raw.githubusercontent.com/myotgo/Proxy/main/layer7-v2ray-vmess/install.sh -o install.sh && bash install.sh
```

نصب خودکار انجام می‌شود.
V2Ray با VMess روی پورت 443 راه‌اندازی می‌شود.

---

--------------------------------------------------
مرحله ۴: اضافه کردن کاربر
--------------------------------------------------

برای هر نفر یک کاربر بسازید. بعد از اضافه کردن کاربر، **۲ کانفیگ JSON** نمایش داده می‌شود:
- کانفیگ iOS (برای NPV Tunnel)
- کانفیگ Android (برای NetMod)

```bash
curl -fsSL https://raw.githubusercontent.com/myotgo/Proxy/main/layer7-v2ray-vmess/add-user.sh -o add-user.sh && bash add-user.sh
```

**توجه:** اگر همان نام کاربری را دوباره اضافه کنید، همان کانفیگ قبلی برگردانده می‌شود.

---

--------------------------------------------------
مرحله ۵: مانیتورینگ کاربران
--------------------------------------------------

برای مشاهده کاربران متصل و وضعیت سرور:

```bash
curl -fsSL https://raw.githubusercontent.com/myotgo/Proxy/main/common/view-users.sh -o view-users.sh && bash view-users.sh
```

---

--------------------------------------------------
مرحله ۶: حذف کاربر (در صورت نیاز)
--------------------------------------------------

```bash
curl -fsSL https://raw.githubusercontent.com/myotgo/Proxy/main/layer7-v2ray-vmess/delete-user.sh -o delete-user.sh && bash delete-user.sh username
```

بعد از حذف، کاربر دیگر نمی‌تواند با کانفیگ قبلی متصل شود.

---

## استفاده در iOS

[راهنمای اتصال با iOS (NPV Tunnel)](./iOS-SETUP.md)

---

## استفاده در Android

[راهنمای اتصال با Android (NetMod)](./ANDROID-SETUP.md)

---

## نکات مهم

- این روش نیاز به کلاینت V2Ray دارد (نه SSH)
- برای iOS: NPV Tunnel
- برای Android: NetMod
- بهترین روش برای سانسور سخت
- UUID و لینک را ایمن نگه دارید

---
